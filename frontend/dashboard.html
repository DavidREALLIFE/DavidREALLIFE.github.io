<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Dashboard - CyberSecure Pro</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="container">
    <h2>Bienvenido al Dashboard</h2>
    <p>Este panel muestra informaci√≥n de usuario (IDOR intencional):</p>
    <div id="user-info"></div>

    <h3>Subir archivo</h3>
    <form action="/upload" method="POST" enctype="multipart/form-data">
      <input type="file" name="file">
      <button type="submit">Subir</button>
    </form>

    <h3>Comentarios</h3>
    <form id="comment-form" action="/comments" method="POST">
      <input type="text" name="author" placeholder="Tu nombre">
      <textarea name="content" placeholder="Comentario"></textarea>
      <button type="submit">Publicar</button>
    </form>

    <section id="comments"></section>
  </div>

  <script src="/js/app.js"></script>
  <script>
    // Mostrar usuario via IDOR demo: consulta ?id=
    async function loadUser(){
      const params = new URLSearchParams(location.search);
      const id = params.get('id') || 1;
      const res = await fetch(`/user?id=${id}`);
      const text = await res.text();
      document.getElementById('user-info').innerHTML = text;
    }
    loadUser();

    // Cargar comentarios (XSS almacenado)
    async function loadComments(){
      const res = await fetch('/comments');
      const json = await res.json();
      const el = document.getElementById('comments');
      el.innerHTML = json.map(c=>`<article><h4>${c.author}</h4><p>${c.content}</p></article>`).join('\n');
    }
    loadComments();
  </script>
</body>
</html>